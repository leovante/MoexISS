micronaut:
  application:
    name: moex-iss
  server:
    port: ${APP_PORT}
    netty:
      worker:
        threads: 1
      parent:
        threads: 1
      childOptions:
        autoRead: true
  http:
    client:
      pool:
        acquire-timeout: 1000ms
        max-pending-acquires: 1000
        enabled: true
        max-connections: 5
    services:
      moex:
        url: https://iss.moex.com
        read-timeout: 60s
        pool:
          max-concurrent-http1-connections: 50
          enabled: true
          max-connections: 50
  http.client.ssl.insecure-trust-all-certificates: true
  codec:
    json:
      additional-types:
        - application/x-ndjson
        - application/octet-stream

datasources:
  liquibase:
    url: jdbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
    username: ${DB_USERNAME}
    password: ${DB_PASSWORD}
    driverClassName: org.postgresql.Driver
    db-type: postgresql
r2dbc:
  datasources:
    default:
      url: r2dbc:postgresql://${DB_HOST}:${DB_PORT}/${DB_NAME}
      username: ${DB_USERNAME}
      password: ${DB_PASSWORD}
      dialect: postgres
      options:
        currentSchema: public
        driver: pool
        protocol:
          postgres
liquibase:
  enabled: true
  datasources:
    liquibase:
      enabled: true
      change-log: 'classpath:db/changelog-master.xml'

app:
  resourceLockTimeout: 10000

logger:
  levels:
    root: INFO
    io.micronaut.http.client: ${LOGGER_HTTP_CLIENT:INFO}
    ru.exdata.moex: ${LOGGER_EXDATA_MOEX:INFO}
